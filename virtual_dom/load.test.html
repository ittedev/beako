<!DOCTYPE html>
<meta charset="UTF-8">
<title>virtual_dom/load.test.js</title>
<link rel="stylesheet" href="https://unpkg.com/mocha/mocha.css" />
<div id="mocha"></div>
<script src="https://unpkg.com/chai/chai.js"></script>
<script>
var i = 0
var equal = (v, p) => {
  try {
    chai.expect(JSON.parse(JSON.stringify(v))).deep.equal(p)
  } catch (e) {
    setTimeout(() => document.querySelectorAll('pre.error')[i++].innerHTML += '\n\n' + Diff.diffJson(v, p).map(p => `<span style="color: ${p.added ? 'red' : p.removed ? 'green' : '#000'}">${p.value}</span>`).join(''), 100)
    throw e
  }
}
</script>
<script src="https://unpkg.com/mocha/mocha.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.0.0/diff.min.js"></script>
<script type="module">
import { load } from './load.js'

mocha.setup('bdd')

describe('load function', function() {
  it('load body', () => {
    const doc = new DOMParser().parseFromString(`<body></body>`, 'text/html')
    const vtree = load(doc.body)
    equal(vtree, {
      node: {}
    })
  })

  it('load body class', () => {
    const doc = new DOMParser().parseFromString(`<body class="class-a class-b"></body>`, 'text/html')
    const vtree = load(doc.body)
    equal(vtree, {
      node: {}
    })
  })

  it('load body part', () => {
    const doc = new DOMParser().parseFromString(`<body part="part-a part-b"></body>`, 'text/html')
    const vtree = load(doc.body)
    equal(vtree, {
      node: {}
    })
  })

  it('load single element', () => {
    const doc = new DOMParser().parseFromString(`<p></p>`, 'text/html')
    const vtree = load(doc.body)
    equal(vtree, {
      children: [
        {
          tag: 'p',
          node: {}
        }
      ],
      node: {}
    })
  })

  it('load multi element', () => {
    const doc = new DOMParser().parseFromString(`<p></p><p></p>`, 'text/html')
    const vtree = load(doc.body)
  })

  it('load style element', () => {
    const doc = new DOMParser().parseFromString(`<style>a { color: red; }</style>`, 'text/html')
    console.log('textContent', doc.body.textContent)
    const vtree = load(doc.body)
  })

  it('load script element', () => {
    const doc = new DOMParser().parseFromString(`<script>console.log('hello');<\/script>`, 'text/html')
    const vtree = load(doc.body)
  })
})
mocha.run()
</script>
